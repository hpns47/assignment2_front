<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>MangaLib - Reviews</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script defer src="js/jquery-setup.js"></script>
    <style>
      .stars-input {
        display: flex;
        flex-direction: row-reverse;
        justify-content: flex-start;
      }

      .stars-input input {
        display: none;
      }

      .stars-input label {
        font-size: 2rem;
        color: #ccc;
        cursor: pointer;
        transition: color 0.2s;
      }

      /* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
      .stars-input label:hover,
      .stars-input label:hover ~ label {
        color: gold;
      }

      /* –ü—Ä–∏ –≤—ã–±–æ—Ä–µ */
      .stars-input input:checked ~ label {
        color: gold;
      }
    </style>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">üìö MangaLib</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link active" href="index.html">Main</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="catalog.html">Catalog</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contact.html">Contacts</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="reviews.html">Reviews</a>
            </li>
            <!-- <li class="nav-item">
              <a class="nav-link" href="faq.html">FAQ</a>
            </li> -->
          </ul>
        </div>

        <div class="d-flex align-items-center gap-2 ms-lg-3 mt-3 mt-lg-0">
          <!-- <label class="text-white-50 small mb-0" for="langSelect">–Ø–∑—ã–∫</label> -->
          <!-- <select id="langSelect" class="form-select form-select-sm w-auto">
            <option value="ru" selected>RU</option>
            <option value="en">EN</option>
            <option value="kz">KZ</option>
          </select> -->

          <!-- Dynamic Style Changes -->
          <button
            id="themeToggle"
            class="btn btn-outline-light btn-sm"
            type="button"
            aria-pressed="false"
          >
            üåô –¢–µ–º–∞
          </button>
        </div>
      </div>
    </nav>


    <main class="container">
      <section aria-labelledby="reviews-heading">
        <h3 id="reviews-heading" class="visually-hidden">Reviews list</h3>
        <div id="reviews" class="reviews-grid">
          <article class="review-card" aria-label="–û—Ç–∑—ã–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ê–ª–∏">
            <div class="review-card__head">
              <div class="review-card__avatar" aria-hidden="true">A</div>
              <div>
                <div class="review-card__name">Ali</div>
                <time class="review-card__date" datetime="2025-09-21"
                  >21.09.2025</time
                >
              </div>
            </div>
            <div
              class="review-card__stars"
              aria-label="–û—Ü–µ–Ω–∫–∞ 5 –∏–∑ 5"
              role="img"
            >
              ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ
            </div>
            <h4 class="review-card__title">One Piece ‚Äî —Ç–æ–ø!</h4>
            <p class="review-card__text">
              –ë–æ–ª—å—à–∞—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è, —Ö–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏. –ú–∞–≥–∞–∑–∏–Ω –æ—Ç–ø—Ä–∞–≤–∏–ª
              –±—ã—Å—Ç—Ä–æ, —É–ø–∞–∫–æ–≤–∫–∞ —Å—É–ø–µ—Ä.
            </p>
          </article>

          <article class="review-card" aria-label="–û—Ç–∑—ã–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ê–ª–∏–Ω–∞">
            <div class="review-card__head">
              <div class="review-card__avatar" aria-hidden="true">–ê</div>
              <div>
                <div class="review-card__name">–ê–ª–∏–Ω–∞</div>
                <time class="review-card__date" datetime="2025-09-20"
                  >20.09.2025</time
                >
              </div>
            </div>
            <div
              class="review-card__stars"
              aria-label="–û—Ü–µ–Ω–∫–∞ 4 –∏–∑ 5"
              role="img"
            >
              ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ
            </div>
            <h4 class="review-card__title">–ù–∞—Ä—É—Ç–æ</h4>
            <p class="review-card__text">
              –ö–∞—á–µ—Å—Ç–≤–æ –ø–µ—á–∞—Ç–∏ –æ—Ç–ª–∏—á–Ω–æ–µ. –•–æ—Ç–µ–ª–æ—Å—å –±—ã –±–æ–ª—å—à–µ –º–µ—Ä—á–∞ –ø–æ –ù–∞—Ä—É—Ç–æ –≤
              –∫–∞—Ç–∞–ª–æ–≥–µ.
            </p>
          </article>
        </div>
      </section>

      <section class="review-form__wrap" aria-labelledby="form-heading">
        <h3 id="form-heading">Leave review</h3>
        <form id="reviewForm" class="review-form" novalidate>
          <div class="form-row">
            <label for="name">Name*</label>
            <input
              id="name"
              name="name"
              type="text"
              required
              maxlength="40"
              placeholder="your name"
            />
            <div class="field-hint" data-for="name"></div>
          </div>

          <div class="form-row">
            <label for="title">Title*</label>
            <input
              id="title"
              name="title"
              type="text"
              required
              maxlength="80"
              placeholder="little about main"
            />
            <div class="field-hint" data-for="title"></div>
          </div>

          <div class="form-row">
            <label for="text">Review*</label>
            <textarea
              id="text"
              name="text"
              required
              rows="5"
              maxlength="800"
              placeholder="share your thoughts!"
            ></textarea>
            <div class="field-hint" data-for="text"></div>
          </div>

          <div class="form-row">
            <span class="label">Rate*</span>
            <div
              class="stars-input"
              role="radiogroup"
              aria-label="choose rate"
            >
              <input type="radio" id="rate5" name="rating" value="5" required />
              <label for="rate5" title="5">‚òÖ</label>
              <input type="radio" id="rate4" name="rating" value="4" />
              <label for="rate4" title="4">‚òÖ</label>
              <input type="radio" id="rate3" name="rating" value="3" />
              <label for="rate3" title="3">‚òÖ</label>
              <input type="radio" id="rate2" name="rating" value="2" />
              <label for="rate2" title="2">‚òÖ</label>
              <input type="radio" id="rate1" name="rating" value="1" />
              <label for="rate1" title="1">‚òÖ</label>
            </div>
            <div class="field-hint" data-for="rating"></div>
          </div>

          <div class="form-row checkbox-row">
            <label>
              <input type="checkbox" id="consent" required />
              Accepted terms & conditions*
            </label>
            <div class="field-hint" data-for="consent"></div>
            <br>
          </div>

          <button class="btn" type="submit" style="border-radius: 10px; border:rgb(41, 54, 30) solid; background-color: rgb(241, 113, 70);">Send Review</button>
          <br>
          <p class="form-note">* ‚Äî required fields</p>
        </form>
      </section>
    </main>

    <footer>
      <p>Abdrakhmanov Daniyar & Boranbayev Danial | SE-2408</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="index-features.js"></script>
    <script>
      $(function () {
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∑–≤—ë–∑–¥ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –∏ –∫–ª–∏–∫–µ
        $(".stars-input label").on("mouseenter", function () {
          const index = $(this).index() / 2; // –∏–∑-–∑–∞ label+input
          $(".stars-input label").removeClass("hovered");
          $(this).addClass("hovered");
          $(this).nextAll("label").addClass("hovered");
        });

        $(".stars-input").on("mouseleave", function () {
          $(".stars-input label").removeClass("hovered");
        });

        // –ü—Ä–∏ –∫–ª–∏–∫–µ —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∑–≤—ë–∑–¥—ã
        $(".stars-input input").on("change", function () {
          const val = $(this).val();
          $(".stars-input label").removeClass("selected");
          $(`#rate${val}`).nextAll("label").addBack().addClass("selected");
        });

        // === –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã ===
        const reviewForm = $("#reviewForm");
        const reviewsList = $("#reviews");

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
        const savedReviews = JSON.parse(
          localStorage.getItem("reviews") || "[]"
        );
        savedReviews.forEach(renderReview);

        reviewForm.on("submit", function (e) {
          e.preventDefault();

          const name = $("#name").val().trim();
          const title = $("#title").val().trim();
          const text = $("#text").val().trim();
          const rating = $("input[name='rating']:checked").val();
          const consent = $("#consent").is(":checked");

          if (!name || !title || !text || !rating || !consent) {
            alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!");
            return;
          }

          const review = {
            name,
            title,
            text,
            rating: parseInt(rating),
            date: new Date().toISOString().split("T")[0],
          };

          renderReview(review);
          savedReviews.push(review);
          localStorage.setItem("reviews", JSON.stringify(savedReviews));

          this.reset();
          $(".stars-input label").removeClass("selected");
        });

        function renderReview({ name, title, text, rating, date }) {
          const stars = "‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ".slice(0, rating) + "‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ".slice(0, 5 - rating);
          const shortDate = date.split("-").reverse().join(".");

          const reviewHtml = `
      <article class="review-card">
        <div class="review-card__head">
          <div class="review-card__avatar">${name.charAt(0)}</div>
          <div>
            <div class="review-card__name">${name}</div>
            <time class="review-card__date" datetime="${date}">${shortDate}</time>
          </div>
        </div>
        <div class="review-card__stars">${stars}</div>
        <h4 class="review-card__title">${title}</h4>
        <p class="review-card__text">${text}</p>
      </article>
    `;
          reviewsList.prepend(reviewHtml);
        }
      });
    </script>
  </body>
</html>
